<html lang="en">
<head>
    <meta charset="utf-8">
    <title>D3 Page Template</title>
    <script type="text/javascript" src="d3.js"></script>
</head>
<body>
<script type="text/javascript">
var row = function(d) {
    obj = {
        year: parseInt(d.Year),
        number: parseInt(d.Number.replace(',', '')),
        rate: parseFloat(d.Rate)
    };
    return obj;
};

d3.csv("HomicideDataset.csv", row, function(data) {
	var width = 1250;
    var height = 200;
	var padding = 30;
	var w = 1250;
	var h = height - padding;

	var yScale = d3.scaleLinear()
				   .domain(d3.extent(data, function(d) {
				       return d.number;
                   }))	
				   .range([0, h])

	var xScale = d3.scaleBand()
				   .domain(data.map(function(d) { return d.year; }))
				   .rangeRound([0, w])
				   .paddingInner(0.1);

    var ticks = xScale.domain().filter(function(d,i){ return !(i%10); } );

	var xAxis = d3.axisBottom(xScale)
				   .tickValues(ticks);
    

	var color = d3.scaleSequential(d3.interpolatePlasma)
			      .domain([d3.max(data, function(d) {
			          return d.number;
                  }), d3.min(data, function(d) {
                      return d.number;
                  })]);

    var svg = d3.select('body')
                .append('svg');

    svg.attr("width", width)
	   .attr("height", height);

	svg.append("g")
		  .attr("class", "x axis")
		  .attr("transform", "translate(0," + (h) + ")")
		  .call(xAxis);
		  //.selectAll("text")
		  //.style("text-anchor", "end")
		  //.attr("dx", "-.8em")
		  //.attr("dy", "-.55em")
		  //.attr("transform", "rotate(-90)" );

	var rects = svg.selectAll("rect")
					 .data(data)
					 .enter()
					 .append("rect");

	rects.attr('x', function(d) {
		     return xScale(d.year);
		 })
		 .attr('fill', function(d) {
		     return color(d.number);
		 })
		 .attr('y', function(d) {
			 return (h - (yScale(d.number)));
		 })
         .attr('width', function(d, i) {
		     return xScale.bandwidth();
		 })
		 .attr('height', function(d) {
		     return yScale(d.number);
		 });

});

d3.json("YouthTobaccoUse.json", function(json) {
});
</script>
</body>
</html>
